"use strict";(self.webpackChunktest_site=self.webpackChunktest_site||[]).push([[136],{3905:(e,t,r)=>{r.d(t,{Zo:()=>c,kt:()=>y});var n=r(67294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var i=n.createContext({}),u=function(e){var t=n.useContext(i),r=t;return e&&(r="function"==typeof e?e(t):s(s({},t),e)),r},c=function(e){var t=u(e.components);return n.createElement(i.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,o=e.originalType,i=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),p=u(r),m=a,y=p["".concat(i,".").concat(m)]||p[m]||d[m]||o;return r?n.createElement(y,s(s({ref:t},c),{},{components:r})):n.createElement(y,s({ref:t},c))}));function y(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=r.length,s=new Array(o);s[0]=m;var l={};for(var i in t)hasOwnProperty.call(t,i)&&(l[i]=t[i]);l.originalType=e,l[p]="string"==typeof e?e:a,s[1]=l;for(var u=2;u<o;u++)s[u]=r[u];return n.createElement.apply(null,s)}return n.createElement.apply(null,r)}m.displayName="MDXCreateElement"},85162:(e,t,r)=>{r.d(t,{Z:()=>s});var n=r(67294),a=r(86010);const o={tabItem:"tabItem_Ymn6"};function s(e){let{children:t,hidden:r,className:s}=e;return n.createElement("div",{role:"tabpanel",className:(0,a.Z)(o.tabItem,s),hidden:r},t)}},74866:(e,t,r)=>{r.d(t,{Z:()=>v});var n=r(87462),a=r(67294),o=r(86010),s=r(12466),l=r(16550),i=r(91980),u=r(67392),c=r(50012);function p(e){return function(e){return a.Children.map(e,(e=>{if(!e||(0,a.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}(e).map((e=>{let{props:{value:t,label:r,attributes:n,default:a}}=e;return{value:t,label:r,attributes:n,default:a}}))}function d(e){const{values:t,children:r}=e;return(0,a.useMemo)((()=>{const e=t??p(r);return function(e){const t=(0,u.l)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,r])}function m(e){let{value:t,tabValues:r}=e;return r.some((e=>e.value===t))}function y(e){let{queryString:t=!1,groupId:r}=e;const n=(0,l.k6)(),o=function(e){let{queryString:t=!1,groupId:r}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!r)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return r??null}({queryString:t,groupId:r});return[(0,i._X)(o),(0,a.useCallback)((e=>{if(!o)return;const t=new URLSearchParams(n.location.search);t.set(o,e),n.replace({...n.location,search:t.toString()})}),[o,n])]}function f(e){const{defaultValue:t,queryString:r=!1,groupId:n}=e,o=d(e),[s,l]=(0,a.useState)((()=>function(e){let{defaultValue:t,tabValues:r}=e;if(0===r.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!m({value:t,tabValues:r}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${r.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const n=r.find((e=>e.default))??r[0];if(!n)throw new Error("Unexpected error: 0 tabValues");return n.value}({defaultValue:t,tabValues:o}))),[i,u]=y({queryString:r,groupId:n}),[p,f]=function(e){let{groupId:t}=e;const r=function(e){return e?`docusaurus.tab.${e}`:null}(t),[n,o]=(0,c.Nk)(r);return[n,(0,a.useCallback)((e=>{r&&o.set(e)}),[r,o])]}({groupId:n}),b=(()=>{const e=i??p;return m({value:e,tabValues:o})?e:null})();(0,a.useLayoutEffect)((()=>{b&&l(b)}),[b]);return{selectedValue:s,selectValue:(0,a.useCallback)((e=>{if(!m({value:e,tabValues:o}))throw new Error(`Can't select invalid tab value=${e}`);l(e),u(e),f(e)}),[u,f,o]),tabValues:o}}var b=r(72389);const k={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};function h(e){let{className:t,block:r,selectedValue:l,selectValue:i,tabValues:u}=e;const c=[],{blockElementScrollPositionUntilNextRender:p}=(0,s.o5)(),d=e=>{const t=e.currentTarget,r=c.indexOf(t),n=u[r].value;n!==l&&(p(t),i(n))},m=e=>{let t=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const r=c.indexOf(e.currentTarget)+1;t=c[r]??c[0];break}case"ArrowLeft":{const r=c.indexOf(e.currentTarget)-1;t=c[r]??c[c.length-1];break}}t?.focus()};return a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,o.Z)("tabs",{"tabs--block":r},t)},u.map((e=>{let{value:t,label:r,attributes:s}=e;return a.createElement("li",(0,n.Z)({role:"tab",tabIndex:l===t?0:-1,"aria-selected":l===t,key:t,ref:e=>c.push(e),onKeyDown:m,onClick:d},s,{className:(0,o.Z)("tabs__item",k.tabItem,s?.className,{"tabs__item--active":l===t})}),r??t)})))}function w(e){let{lazy:t,children:r,selectedValue:n}=e;const o=(Array.isArray(r)?r:[r]).filter(Boolean);if(t){const e=o.find((e=>e.props.value===n));return e?(0,a.cloneElement)(e,{className:"margin-top--md"}):null}return a.createElement("div",{className:"margin-top--md"},o.map(((e,t)=>(0,a.cloneElement)(e,{key:t,hidden:e.props.value!==n}))))}function g(e){const t=f(e);return a.createElement("div",{className:(0,o.Z)("tabs-container",k.tabList)},a.createElement(h,(0,n.Z)({},e,t)),a.createElement(w,(0,n.Z)({},e,t)))}function v(e){const t=(0,b.Z)();return a.createElement(g,(0,n.Z)({key:String(t)},e))}},82400:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>y,frontMatter:()=>l,metadata:()=>u,toc:()=>p});var n=r(87462),a=(r(67294),r(3905)),o=r(74866),s=r(85162);const l={sidebar_label:"Password Protection"},i="Password Protection",u={unversionedId:"Cookbook/drops/customizations/password",id:"Cookbook/drops/customizations/password",title:"Password Protection",description:"This part of the cookbook contains everything related password protecting your drops.",source:"@site/docs/Cookbook/drops/customizations/password.md",sourceDirName:"Cookbook/drops/customizations",slug:"/Cookbook/drops/customizations/password",permalink:"/docs/Cookbook/drops/customizations/password",draft:!1,editUrl:"https://github.com/keypom/keypom-docs/tree/main/docs/Cookbook/drops/customizations/password.md",tags:[],version:"current",frontMatter:{sidebar_label:"Password Protection"},sidebar:"Cookbook",previous:{title:"Trial Account Drops",permalink:"/docs/Cookbook/drops/trial"},next:{title:"Drop Configurations",permalink:"/docs/Cookbook/drops/customizations/dropConfig"}},c={},p=[{value:"Getting Started",id:"getting-started",level:2},{value:"Password Protecting your Entire Drop",id:"password-protecting-your-entire-drop",level:2},{value:"Claiming a Password-Protected Key",id:"claiming-a-password-protected-key",level:2},{value:"Password Protecting a Specific Key Use",id:"password-protecting-a-specific-key-use",level:2},{value:"Delete Drop",id:"delete-drop",level:2}],d={toc:p},m="wrapper";function y(e){let{components:t,...r}=e;return(0,a.kt)(m,(0,n.Z)({},d,r,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"password-protection"},"Password Protection"),(0,a.kt)("p",null,"This part of the cookbook contains everything related password protecting your drops."),(0,a.kt)("h2",{id:"getting-started"},"Getting Started"),(0,a.kt)("p",null,"For the cookbook, you will need the following installed. "),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("a",{parentName:"li",href:"https://docs.npmjs.com/downloading-and-installing-node-js-and-npm"},"Node JS"),"  "),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/keypom/keypom-js#getting-started"},"Keypom JS SDK"))),(0,a.kt)("admonition",{title:"note",type:"info"},(0,a.kt)("p",{parentName:"admonition"},"These scripts will not run without the proper setup shown in the ",(0,a.kt)("a",{parentName:"p",href:"/docs/Cookbook/welcome#connection-to-near-and-initializing-the-sdk"},"introduction page"),".")),(0,a.kt)("h2",{id:"password-protecting-your-entire-drop"},"Password Protecting your Entire Drop"),(0,a.kt)("p",null,"Password protecting your drop prevents unauthorized people from claiming keys in your drop. A claim will fail if the ",(0,a.kt)("a",{parentName:"p",href:"#claiming-a-password-protected-key"},(0,a.kt)("em",{parentName:"a"},"actual password"))," (base password is NOT the claiming password) is not included in the claim transaction. "),(0,a.kt)(o.Z,{mdxType:"Tabs"},(0,a.kt)(s.Z,{value:"SDK",label:"\ud83d\udd11 Keypom SDK",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'// Create drop with 1 single use password protected key\nlet {keys, dropId} = await createDrop({\n    account: fundingAccount,\n    numKeys: 1,\n    depositPerUseNEAR: "0.1",\n    basePassword: "base-password"\n})\n\nconsole.log(keys)\n')))),(0,a.kt)("hr",null),(0,a.kt)("h2",{id:"claiming-a-password-protected-key"},"Claiming a Password-Protected Key"),(0,a.kt)("p",null,"When claiming a password protected key, the password is not actually the base password. The base password is just one component that is universal for all keys across the entire drop. The actual password for each claim is different but follows the following format format:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"hash(basePassword + publicKey + current_key_use)\n")),(0,a.kt)(o.Z,{mdxType:"Tabs"},(0,a.kt)(s.Z,{value:"SDK",label:"\ud83d\udd11 Keypom SDK",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'let base_password = "base-password"\n\n// Create drop with 1 password protected key\nlet {keys, dropId} = await createDrop({\n    account: fundingAccount,\n    numKeys: 1,\n    depositPerUseNEAR: "0.1",\n    basePassword: base_password\n})\n\n// Create password using base + pubkey + key use as string\nconst keyInfo1 = await getKeyInformation({\n    publicKey: keys.publicKeys[0]\n})\nlet passwordForClaim = await hashPassword(base_password + keys.publicKeys[0] + keyInfo1.cur_key_use.toString())\n\n// Claim with created password\nawait claim({\n    accountId: "minqianlu.testnet",\n    secretKey: keys.secretKeys[0],\n    password: passwordForClaim\n})\n')))),(0,a.kt)("hr",null),(0,a.kt)("h2",{id:"password-protecting-a-specific-key-use"},"Password Protecting a Specific Key Use"),(0,a.kt)("p",null,"Rather than password protecting your entire drop, you may only want to protect certain key uses. A great use case of this is for ",(0,a.kt)("a",{parentName:"p",href:"/docs/Tutorials/Advanced/ticketing/architecture#attendance-required-for-poap"},"ticketing"),", when a bouncer would scan your ticket to claim your key and admit you into the event but only they know the password. This would prevent people admitting themselves into the event and gaining access to any POAPs and goodies available only to those who physically attend. "),(0,a.kt)("p",null,"To specify key uses to password protect, simply add it to the ",(0,a.kt)("inlineCode",{parentName:"p"},"passwordProtectedUses")," array. "),(0,a.kt)(o.Z,{mdxType:"Tabs"},(0,a.kt)(s.Z,{value:"SDK",label:"\ud83d\udd11 Keypom SDK",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'// Create drop with 10 password protected keys and 5 key uses each\nlet {keys, dropId} = await createDrop({\n    account: fundingAccount,\n    numKeys: 10,\n    config:{\n        usesPerKey: 5\n    },\n    depositPerUseNEAR: "0.1",\n    basePassword: "base-password",\n    // Password protect the first, third and fourth key uses\n    passwordProtectedUses: [1, 3, 4],\n})\n\nconsole.log(keys)\n')))),(0,a.kt)("hr",null),(0,a.kt)("h2",{id:"delete-drop"},"Delete Drop"),(0,a.kt)("p",null,"A drop can be deleted manually at any time using ",(0,a.kt)("inlineCode",{parentName:"p"},"deleteDrops"),". This will refund all unclaimed key balances back to the drop funder's Keypom balance. "),(0,a.kt)(o.Z,{mdxType:"Tabs"},(0,a.kt)(s.Z,{value:"SDK",label:"\ud83d\udd11 Keypom SDK",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'// Get all the drops for a given user\nlet drops = await getDrops({accountId: "minqi.testnet"});\n\n// Delete all the drops currently funded by `minqi.testnet`\nawait deleteDrops({\n    account: fundingAccount,\n    drops\n})\n\n// Delete 2 seperate drops given their IDs\nawait deleteDrops({\n    account: fundingAccount,\n    dropIds: ["123123123123123", "12391238012380123"]\n})\n')))),(0,a.kt)("hr",null))}y.isMDXComponent=!0}}]);